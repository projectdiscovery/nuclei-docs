


<!doctype html>
<html lang="en" class="no-js">
  <head>
    <!-- Snitcher analytics code -->
    <script>
        !function(s,n,i,t,c,h){s.SnitchObject=i;s[i]||(s[i]=function(){
        (s[i].q=s[i].q||[]).push(arguments)});s[i].l=+new Date;c=n.createElement(t);
        h=n.getElementsByTagName(t)[0];c.src='//snid.snitcher.com/8419641.js';
        h.parentNode.insertBefore(c,h)}(window,document,'snid','script');

        snid('verify', '8419641');
    </script>

    <!-- clearbitscripts analytics code -->
    <script async src="https://tag.clearbitscripts.com/v1/pk_dba61775644268d3609bf7dd90c0642b/tags.js"></script>
    
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Learn how to use Nuclei engine to write your own custom security checks with very simple and easy to use templating syntax.">
      
      
        <link rel="canonical" href="https://nuclei.projectdiscovery.io/kr/templating-guide/protocols/http/">
      
      
      <link rel="shortcut icon" href="../../../../static/favicon.png">
      <meta name="generator" content="mkdocs-1.5.1, mkdocs-material-5.5.0">
    
    
      
        <title>Http - Nuclei - Community Powered Vulnerability Scanner</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.18dbb20c.min.css">
      
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.0ec9b792.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Nunito Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-165996103-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#headers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://nuclei.projectdiscovery.io/" title="Nuclei - Community Powered Vulnerability Scanner" class="md-header-nav__button md-logo" aria-label="Nuclei - Community Powered Vulnerability Scanner">
      
  <img src="../../../../static/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Nuclei - Community Powered Vulnerability Scanner
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Http
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/projectdiscovery/nuclei-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../.." class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../nuclei/get-started/" class="md-tabs__link">
          Getting Started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../templating-guide/" class="md-tabs__link">
          Templating Guide
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../template-examples/http/" class="md-tabs__link">
          Template Examples
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../../faq/nuclei/" class="md-tabs__link">
          FAQ
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://nuclei.projectdiscovery.io/" title="Nuclei - Community Powered Vulnerability Scanner" class="md-nav__button md-logo" aria-label="Nuclei - Community Powered Vulnerability Scanner">
      
  <img src="../../../../static/logo.png" alt="logo">

    </a>
    Nuclei - Community Powered Vulnerability Scanner
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/projectdiscovery/nuclei-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Home
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Home" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../.." title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting Started
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../nuclei/get-started/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../nuclei/get-started/#nuclei-features" title="Features" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../nuclei/get-started/#code-contribution" title="Contribution" class="md-nav__link">
      Contribution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../nuclei/get-started/#license" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Templating Guide
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Templating Guide" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Templating Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/#template-details" title="Template Details" class="md-nav__link">
      Template Details
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      HTTP
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="HTTP" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        HTTP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http/" title="Base HTTP" class="md-nav__link">
      Base HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http#raw-http-requests" title="Raw HTTP" class="md-nav__link">
      Raw HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http#http-payloads" title="HTTP payloads" class="md-nav__link">
      HTTP payloads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http-fuzzing/" title="HTTP Fuzzing" class="md-nav__link">
      HTTP Fuzzing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http#unsafe-http-requests" title="Unsafe HTTP" class="md-nav__link">
      Unsafe HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/http#advance-requests" title="Advance HTTP" class="md-nav__link">
      Advance HTTP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/headless/" title="Headless" class="md-nav__link">
      Headless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/dns/" title="DNS" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/protocols/code/" title="Code" class="md-nav__link">
      Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      Operators
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Operators" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Operators
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/operators/matchers/" title="Matchers" class="md-nav__link">
      Matchers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/operators/extractors/" title="Extractors" class="md-nav__link">
      Extractors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/interactsh/" title="OOB Testing" class="md-nav__link">
      OOB Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/helper-functions/" title="Helper Functions" class="md-nav__link">
      Helper Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/variables/" title="Variables" class="md-nav__link">
      Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/preprocessors/" title="Preprocessors" class="md-nav__link">
      Preprocessors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/workflows/" title="Workflows" class="md-nav__link">
      Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../templating-guide/multiprotocol/" title="Multi Protocol Execution" class="md-nav__link">
      Multi Protocol Execution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Template Examples
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Template Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Template Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      HTTP
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="HTTP" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        HTTP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http/" title="Base HTTP" class="md-nav__link">
      Base HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http-raw/" title="Raw HTTP" class="md-nav__link">
      Raw HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http-fuzzing/" title="HTTP Fuzzing" class="md-nav__link">
      HTTP Fuzzing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http-smuggling/" title="Unsafe HTTP" class="md-nav__link">
      Unsafe HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http-payloads/" title="HTTP Payloads" class="md-nav__link">
      HTTP Payloads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/http-race-conditions/" title="Race Condition" class="md-nav__link">
      Race Condition
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/dns/" title="DNS" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/headless/" title="Headless" class="md-nav__link">
      Headless
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/network/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/workflow/" title="Workflow" class="md-nav__link">
      Workflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../template-examples/helper-functions/" title="Helpers" class="md-nav__link">
      Helpers
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      FAQ
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="FAQ" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        FAQ
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../faq/nuclei/" title="Nuclei FAQ" class="md-nav__link">
      Nuclei FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../faq/templates/" title="Templates FAQ" class="md-nav__link">
      Templates FAQ
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    Headers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#body" class="md-nav__link">
    Body
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session" class="md-nav__link">
    Session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-condition" class="md-nav__link">
    Request Condition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-http-template" class="md-nav__link">
    Example HTTP Template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#raw-http-requests" class="md-nav__link">
    RAW HTTP requests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#http-fuzzing" class="md-nav__link">
    HTTP Fuzzing
  </a>
  
    <nav class="md-nav" aria-label="HTTP Fuzzing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack-mode" class="md-nav__link">
    Attack mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unsafe-http-requests" class="md-nav__link">
    Unsafe HTTP Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advance-fuzzing" class="md-nav__link">
    Advance Fuzzing
  </a>
  
    <nav class="md-nav" aria-label="Advance Fuzzing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipelining" class="md-nav__link">
    Pipelining
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connection-pooling" class="md-nav__link">
    Connection pooling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smuggling" class="md-nav__link">
    Smuggling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#race-conditions" class="md-nav__link">
    Race conditions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/projectdiscovery/nuclei-docs/edit/main/docs/kr/templating-guide/protocols/http.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                  <h1>Http</h1>
                
                <div class="admonition info">
<p class="admonition-title">Requests</p>
<p>Nuclei는 HTTP 프로토콜과 관련된 다양한 기능을 광범위하게 지원합니다. None-RFC 클라이언트 요청도 지원하는 옵션과 함께 raw 및 모델 기반 HTTP 요청이 지원됩니다. 페이로드를 지정할 수도 있고 페이로드 값을 기반으로 raw 요청을 변환할 수 있으며 이 페이지의 뒷부분에 표시되는 더 많은 기능을 사용할 수 있습니다.</p>
<p>HTTP 요청은 템플릿에 대한 요청의 시작을 지정하는 'request' 블록으로 시작합니다.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># 템플릿 요청을 바로 여기에서 시작하세요.</span>
<span class="nt">http</span><span class="p">:</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Method</p>
<p>요청 방법은 필요에 따라 <strong>GET</strong>, <strong>POST</strong>, <strong>PUT</strong>, <strong>DELETE</strong> 등이 될 수 있습니다.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># Method는 요청에 대한 메소드입니다.</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Redirects</p>
<p>각 템플릿별로 리디렉션 조건을 지정할 수 있습니다. 기본적으로 리디렉션은 따르지 않습니다. 그러나 원하는 경우 요청 세부정보에서 'redirects: true'로 활성화할 수 있습니다. 기본적으로 최대 10개의 리디렉션이 따르므로 대부분의 사용 사례에 충분합니다. 'max-redirects' 필드를 사용하여 리디렉션 수에 대해 더 세분화된 제어를 실행할 수 있습니다.</p>
</div>
<p>사용법의 예:</p>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{BaseURL}}/login.php&quot;</span>
<span class="w">    </span><span class="nt">redirects</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">max-redirects</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>현재 리디렉션은 요청별로가 아니라 템플릿별로 정의됩니다.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Path</p>
<p>요청의 다음 부분은 요청 경로의 **path**입니다. 동적 변수를 경로에 배치하여 런타임 시 동작을 수정할 수 있습니다.</p>
<p>변수는 <code>{{</code>로 시작하고 <code>}}</code>로 끝나며 대소문자를 구분합니다.</p>
<p><strong>{{BaseURL}}</strong> - 이것은 요청의 런타임 시 대상 파일에 지정된 Base URL로 대체됩니다.</p>
<p><strong>{{RootURL}}</strong> - 이것은 요청의 런타임 시 대상 파일에 지정된 Root URL로 대체됩니다.</p>
<p><strong>{{Hostname}}</strong> - 호스트 이름 변수는 런타임에 대상의 포트를 포함하는 Hostname으로 대체됩니다.</p>
<p><strong>{{Host}}</strong> - 이것은 대상 파일에 지정된 대로 입력 Host에 의한 요청의 런타임 시 대체됩니다.</p>
<p><strong>{{Port}}</strong> - 이것은 요청의 런타임 시 대상 파일에 지정된 입력 Port로 대체됩니다.</p>
<p><strong>{{Path}}</strong> - 이것은 요청의 런타임 시 대상 파일에 지정된 입력 Path로 대체됩니다.</p>
<p><strong>{{File}}</strong> - 이것은 요청의 런타임 시 대상 파일에 지정된 입력 파일 이름으로 대체합니다.</p>
<p><strong>{{Scheme}}</strong> - 이것은 대상 파일에 지정된 프로토콜 체계에 의한 요청의 런타임 시 대체됩니다.</p>
</div>
<p>아래에 예가 제공됩니다. - <a href="https://example.com:443/foo/bar.php">https://example.com:443/foo/bar.php</a></p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>{{BaseURL}}</td>
<td><a href="https://example.com:443/foo/bar.php">https://example.com:443/foo/bar.php</a></td>
</tr>
<tr>
<td>{{RootURL}}</td>
<td><a href="https://example.com:443">https://example.com:443</a></td>
</tr>
<tr>
<td>{{Hostname}}</td>
<td>example.com:443</td>
</tr>
<tr>
<td>{{Host}}</td>
<td>example.com</td>
</tr>
<tr>
<td>{{Port}}</td>
<td>443</td>
</tr>
<tr>
<td>{{Path}}</td>
<td>/foo</td>
</tr>
<tr>
<td>{{File}}</td>
<td>bar.php</td>
</tr>
<tr>
<td>{{Scheme}}</td>
<td>https</td>
</tr>
</tbody>
</table>
<p>몇 가지 샘플 동적 변수 대체 예:</p>
<div class="highlight"><pre><span></span><code><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{BaseURL}}/.git/config&quot;</span>
<span class="c1"># 이 경로는 실행 시 BaseURL로 대체됩니다.</span>
<span class="c1"># BaseURL이 https://abc.com 으로 설정된 경우</span>
<span class="c1"># 경로는 https://abc.com/.git/config 로 대체됩니다.</span>
</code></pre></div>
<p>대상에 대해 요청될 하나의 요청에 여러 경로를 지정할 수도 있습니다.</p>
<h4 id="headers">Headers<a class="headerlink" href="#headers" title="Permanent link">&para;</a></h4>
<p>Headers는 요청과 함께 보내도록 지정할 수도 있습니다. 헤더는 키/값 쌍의 형태로 배치됩니다. 헤더 구성의 예는 다음과 같습니다:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># headers contain the headers for the request</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Custom user-agent header</span>
<span class="w">  </span><span class="nt">User-Agent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Some-Random-User-Agent</span>
<span class="w">  </span><span class="c1"># Custom request origin</span>
<span class="w">  </span><span class="nt">Origin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://google.com</span>
</code></pre></div>
<h4 id="body">Body<a class="headerlink" href="#body" title="Permanent link">&para;</a></h4>
<p>Body는 요청과 함께 보낼 본문을 지정합니다. 예를 들어:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Body는 요청과 함께 전송되는 문자열입니다.</span>
<span class="nt">body</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{\&quot;some</span><span class="nv"> </span><span class="s">random</span><span class="nv"> </span><span class="s">JSON\&quot;}&quot;</span>

<span class="c1"># Body는 요청과 함께 전송되는 문자열입니다.</span>
<span class="nt">body</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin=test&quot;</span>
</code></pre></div>
<h4 id="session">Session<a class="headerlink" href="#session" title="Permanent link">&para;</a></h4>
<p>여러 요청 간에 세션과 같은 쿠키 기반 브라우저를 유지하려면 템플릿에서 <code>cookie-reuse: true</code>를 사용하면 됩니다. 익스플로잇 체인을 완료하고 인증된 스캔을 수행하기 위해 일련의 요청 간에 세션을 유지하려는 경우에 유용합니다.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cookie-reuse는 기본적으로 부울 입력 및 false를 허용합니다.</span>
<span class="nt">cookie-reuse</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h4 id="request-condition">Request Condition<a class="headerlink" href="#request-condition" title="Permanent link">&para;</a></h4>
<p>요청 조건을 사용하면 복잡한 검사를 작성하기 위한 여러 요청과 익스플로잇 체인을 완료하기 위한 여러 HTTP 요청을 포함하는 익스플로잇 간의 조건을 확인할 수 있습니다.</p>
<p>DSL 매처와 함께 <code>req-condition: true</code>와 각 속성의 접미사로 숫자를 추가하여 활용할 수 있습니다(예: <code>status_code_1</code>, <code>status_code_3</code>, <code>body_2</code>).</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">req-condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dsl</span>
<span class="w">        </span><span class="nt">dsl</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;status_code_1</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">status_code_2</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">200</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">contains((body_2),</span><span class="nv"> </span><span class="s">&#39;secret_string&#39;)&quot;</span>
</code></pre></div>
<h4 id="example-http-template"><strong>Example HTTP Template</strong><a class="headerlink" href="#example-http-template" title="Permanent link">&para;</a></h4>
<p>위에서 언급한 <code>.git/config</code> 파일의 최종 템플릿 파일은 다음과 같습니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">git-config</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Git Config File</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ice3man</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">medium</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Searches for the pattern /.git/config on passed URLs.</span>

<span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{BaseURL}}/.git/config&quot;</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;[core]&quot;</span>
</code></pre></div>
<h3 id="raw-http-requests">RAW HTTP requests<a class="headerlink" href="#raw-http-requests" title="Permanent link">&para;</a></h3>
<p>요청을 생성하는 또 다른 방법은 다음과 같은 DSL 도우미 기능을 더 유연하게 지원하고 지원하는 Raw 요청을 사용하는 것입니다(현재로서는 <code>{{Hostname}}</code>), 모든 Matcher, Extractor 기능은 위에서 설명한 것과 동일한 방식으로 RAW 요청과 함께 사용할 수 있습니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST /path2/ HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>

<span class="w">        </span><span class="no">a=test&amp;b=pd</span>
</code></pre></div>
<p>원하는 대로 정확한 작업을 수행하도록 요청을 미세 조정할 수 있습니다. Nuclei 요청은 완전히 구성할 수 있음을 의미합니다. 즉, 대상 서버로 보낼 요청에 대한 모든 것을 구성하고 정의할 수 있습니다.</p>
<p>RAW 요청 형식은 <a href="https://nuclei.projectdiscovery.io/templating-guide/helper-functions/">various helper functions</a>도 지원하므로 입력으로 런타임 조작이 가능합니다. 헤더에 도우미 함수를 사용하는 예입니다. </p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">GET /manager/html HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Authorization: Basic {{base64(&#39;username:password&#39;)}} # Helper function to encode input at run time.</span>
</code></pre></div>
<p>추가 변조 없이 입력으로 지정된 URL에 대한 요청을 수행하려면 아래 지정된 대로 빈 요청 URI를 사용하여 사용자 지정 입력에 대한 요청을 수행할 수 있습니다.</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">GET HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
</code></pre></div>
<h3 id="http-fuzzing">HTTP Fuzzing<a class="headerlink" href="#http-fuzzing" title="Permanent link">&para;</a></h3>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Nuclei engine supports fuzzing module that allow to run various type of payloads in multiple format, It's possible to define placeholders with simple keywords (or using brackets <code>{{helper_function(variable)}}</code> in case mutator functions are needed), and perform <strong>batteringram</strong>, <strong>pitchfork</strong> and <strong>clusterbomb</strong> attacks. The wordlist for these attacks needs to be defined during the request definition under the Payload field, with a name matching the keyword, Nuclei supports both file based and in template wordlist support and Finally all DSL functionalities are fully available and supported, and can be used to manipulate the final values.</p>
<p>페이로드는 변수 이름을 사용하여 정의되며 <code>§ §</code> 또는 <code>{{ }}</code> 마커 사이에서 요청에서 참조할 수 있습니다.</p>
</div>
<p>로컬 단어 목록과 함께 페이로드를 사용하는 예:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># HTTP Intruder fuzzing using local wordlist.</span>

<span class="w">    </span><span class="nt">payloads</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">params.txt</span>
<span class="w">      </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">local.txt</span>
</code></pre></div>
<p>템플릿 단어 목록 지원과 함께 페이로드를 사용하는 예:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1"># HTTP Intruder fuzzing using in template wordlist.</span>

<span class="w">    </span><span class="nt">payloads</span><span class="p">:</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guest</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</code></pre></div>
<p><strong>Note:</strong> 예기치 않은 입력이 템플릿을 손상시키므로 공격 유형을 선택할 때 주의하십시오. </p>
<p>예를 들어 <code>clusterbomb</code> 또는 <code>pitchfork</code>를 공격 유형으로 사용하고 페이로드 섹션에 하나의 변수만 정의한 경우 <code>clusterbomb</code> 또는 <code>pitchfork</code>가 템플릿에서 둘 이상의 변수를 사용할 것으로 예상하므로 템플릿은 컴파일되지 않습니다.</p>
<h4 id="attack-mode">Attack mode<a class="headerlink" href="#attack-mode" title="Permanent link">&para;</a></h4>
<p>Nuclei 엔진은 일반적으로 단일 매개변수를 퍼징하는 데 사용되는 기본 유형인 <code>batteringram</code>, 클래식 burp 침입자와 동일하게 작동하는 여러 매개변수를 퍼징하는 <code>clusterbomb</code> 및 <code>pitchfork</code>를 포함한 여러 공격 유형을 지원합니다.</p>
<table>
  <tr>
    <th>Type</th>
    <td>batteringram</td>
    <td>pitchfork</td>
    <td>clusterbomb</td>

  </tr>
  <tr>
    <th>Support</th>
    <td><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm16.28-2.72a.75.75 0 00-1.06-1.06l-5.97 5.97-2.47-2.47a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l6.5-6.5z"></path></svg>
    </td>
    <td><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm16.28-2.72a.75.75 0 00-1.06-1.06l-5.97 5.97-2.47-2.47a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l6.5-6.5z"></path></svg>
    </td>
    <td><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill-rule="evenodd" d="M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12zm16.28-2.72a.75.75 0 00-1.06-1.06l-5.97 5.97-2.47-2.47a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l6.5-6.5z"></path></svg>
    </td>
  </tr>
</table>

<div class="admonition abstract">
<p class="admonition-title">batteringram</p>
<p>batteringram 공격 유형은 모든 위치에 동일한 페이로드 값을 배치합니다. 하나의 페이로드 세트만 사용합니다. 페이로드 세트를 반복하고 모든 위치를 페이로드 값으로 바꿉니다.</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">pitchfork</p>
<p>pitchfork 공격 유형은 각 위치에 대해 하나의 페이로드 세트를 사용합니다. 첫 번째 페이로드를 첫 번째 위치에 배치하고 두 번째 페이로드를 두 번째 위치에 배치하는 식입니다.</p>
<p>그런 다음 동시에 모든 페이로드 세트를 반복합니다. 첫 번째 요청은 각 페이로드 세트의 첫 번째 페이로드를 사용하고, 두 번째 요청은 각 페이로드 세트의 두 번째 페이로드를 사용하는 식입니다.</p>
</div>
<div class="admonition abstract">
<p class="admonition-title">clusterbomb</p>
<p>클러스터 폭탄 공격은 다양한 페이로드 조합을 시도합니다. 여전히 첫 번째 페이로드를 첫 번째 위치에 배치하고 두 번째 페이로드를 두 번째 위치에 배치합니다. 그러나 페이로드 세트를 반복할 때 모든 조합을 시도합니다.</p>
<p>그런 다음 동시에 모든 페이로드 세트를 반복합니다. 첫 번째 요청은 각 페이로드 세트의 첫 번째 페이로드를 사용하고, 두 번째 요청은 각 페이로드 세트의 두 번째 페이로드를 사용하는 식입니다.</p>
<p>이 공격 유형은 무차별 대입 공격에 유용합니다. 첫 번째 페이로드 세트에서 일반적으로 사용되는 사용자 이름 목록을 로드하고 두 번째 페이로드 세트에서 일반적으로 사용되는 비밀번호 목록을 로드합니다. 클러스터 폭탄 공격은 모든 조합을 시도합니다.</p>
<p>자세한 내용은 <a href="https://www.sjoerdlangkemper.nl/2017/08/02.burp-intruder-attack-types/">here</a>. </p>
</div>
<p>fuzz에 <code>clusterbomb</code> 공격을 사용한 예.</p>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST /?file={{path}} HTTP/1.1</span>
<span class="w">        </span><span class="no">User-Agent: {{header}}</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>

<span class="w">    </span><span class="nt">payloads</span><span class="p">:</span>
<span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">helpers/wordlists/prams.txt</span>
<span class="w">      </span><span class="nt">header</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">helpers/wordlists/header.txt</span>
<span class="w">    </span><span class="nt">attack</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">clusterbomb</span><span class="w"> </span><span class="c1"># Defining HTTP fuzz attack type</span>
</code></pre></div>
<h4 id="unsafe-http-requests">Unsafe HTTP Requests<a class="headerlink" href="#unsafe-http-requests" title="Permanent link">&para;</a></h4>
<p>Nuclei는 HTTP reqeust smuggling, Host header injection, 잘못된 문자가 포함된 CRLF 등과 같은 문제에 대해 **any kind of malformed requests**을 허용하는 완전한 요청 제어 및 지정을 위한 <a href="https://github.com/projectdiscovery/rawhttp">rawhttp</a>를 지원합니다.</p>
<p><strong>rawhttp</strong> 라이브러리는 기본적으로 비활성화되어 있으며 요청 블록에 <code>unsafe: true</code>를 포함하여 활성화할 수 있습니다.</p>
<p>다음은 <code>rawhttp</code>를 사용한 HTTP 요청 밀수 탐지 템플릿의 예입니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>
<span class="w">        </span><span class="no">Content-Length: 150</span>
<span class="w">        </span><span class="no">Transfer-Encoding: chunked</span>

<span class="w">        </span><span class="no">0</span>

<span class="w">        </span><span class="no">GET /post?postId=5 HTTP/1.1</span>
<span class="w">        </span><span class="no">User-Agent: a&quot;/&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span>
<span class="w">        </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>
<span class="w">        </span><span class="no">Content-Length: 5</span>

<span class="w">        </span><span class="no">x=1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">        </span><span class="no">GET /post?postId=5 HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>

<span class="w">    </span><span class="nt">unsafe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"> </span><span class="c1"># Enables rawhttp client</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dsl</span>
<span class="w">        </span><span class="nt">dsl</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;contains(body,</span><span class="nv"> </span><span class="s">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;)&#39;</span>
</code></pre></div>
<h3 id="advance-fuzzing">Advance Fuzzing<a class="headerlink" href="#advance-fuzzing" title="Permanent link">&para;</a></h3>
<p>우리는 웹 서버의 고급 퍼징을 허용하기 위해 nuclei을 강화했습니다. 이제 사용자는 여러 옵션을 사용하여 HTTP 퍼징 워크플로를 조정할 수 있습니다.</p>
<h4 id="pipelining">Pipelining<a class="headerlink" href="#pipelining" title="Permanent link">&para;</a></h4>
<p>HTTP 파이프라이닝 지원이 추가되어 다음에서 영감을 받은 동일한 연결에서 여러 HTTP 요청을 보낼 수 있습니다. <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn">http-desync-attacks-request-smuggling-reborn</a>.</p>
<p>HTTP 파이프라인 기반 템플릿을 실행하기 전에 실행 중인 대상이 HTTP 파이프라인 연결을 지원하는지 확인하십시오. 그렇지 않으면 핵 엔진이 표준 HTTP 요청 엔진으로 폴백합니다.</p>
<p>주어진 도메인 또는 하위 도메인 목록이 HTTP 파이프라이닝을 지원하는지 확인하려면 <a href="https://github.com/projectdiscovery/">httpx</a>에 <code>-pipeline</code> 플래그가 있습니다.</p>
<p>nuclei의 파이프라이닝 속성을 표시하는 구성의 예입니다.</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">unsafe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pipeline</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pipeline-concurrent-connections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">    </span><span class="nt">pipeline-requests-per-connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25000</span>
</code></pre></div>
<p>nuclei의 파이프라이닝 기능을 보여주는 예제 템플릿이 아래에 제공되었습니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pipeline-testing</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pipeline testing</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdteam</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>

<span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">        </span><span class="no">GET /{{path}} HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Referer: {{BaseURL}}</span>

<span class="w">    </span><span class="nt">attack</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batteringram</span>
<span class="w">    </span><span class="nt">payloads</span><span class="p">:</span>
<span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path_wordlist.txt</span>

<span class="w">    </span><span class="nt">unsafe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pipeline</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pipeline-concurrent-connections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">    </span><span class="nt">pipeline-requests-per-connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25000</span>

<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">part</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">header</span>
<span class="w">        </span><span class="nt">status</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
</code></pre></div>
<h4 id="connection-pooling">Connection pooling<a class="headerlink" href="#connection-pooling" title="Permanent link">&para;</a></h4>
<p>이전 버전의 nuclei는 연결 풀링을 수행하지 않았지만 이제 사용자는 HTTP 연결 풀링을 사용하거나 사용하지 않도록 템플릿을 구성할 수 있습니다. 이를 통해 요구 사항에 따라 더 빠른 스캔이 가능합니다.</p>
<p>템플릿에서 연결 풀링을 활성화하려면 페이로드 섹션에서 사용하려는 각 스레드 수로 <code>threads</code> 속성을 정의할 수 있습니다.</p>
<p><code>Connection: Close</code> 헤더는 HTTP 연결 풀링 템플릿에서 사용할 수 없습니다. 그렇지 않으면 엔진이 실패하고 풀링이 있는 표준 HTTP 요청으로 대체됩니다.</p>
<p>HTTP 연결 풀링을 사용하는 예제 템플릿-</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fuzzing-example</span>
<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Connection pooling example</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdteam</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>

<span class="nt">http</span><span class="p">:</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">GET /protected HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Authorization: Basic {{base64(&#39;admin:§password§&#39;)}}</span>

<span class="w">    </span><span class="nt">attack</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">batteringram</span>
<span class="w">    </span><span class="nt">payloads</span><span class="p">:</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password.txt</span>
<span class="w">    </span><span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>

<span class="w">    </span><span class="nt">matchers-condition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">and</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">status</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Unique</span><span class="nv"> </span><span class="s">string&quot;</span>
<span class="w">        </span><span class="nt">part</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">body</span>
</code></pre></div>
<h4 id="smuggling">Smuggling<a class="headerlink" href="#smuggling" title="Permanent link">&para;</a></h4>
<p>HTTP Smuggling은 최근 <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn">Portswigger's Research</a>에서 화제가 된 웹 공격 클래스입니다. 자세한 개요는 위에 링크된 기사를 참조하십시오.</p>
<p>오픈 소스 공간에서 http 밀수 탐지는 특히 탐지 요청의 특성상 기형적이기 때문에 탐지가 어렵습니다. Nuclei는 <a href="https://github.com/projectdiscovery/rawhttp">rawhttp</a> 엔진을 활용하여 HTTP Smuggling 취약점을 안정적으로 탐지할 수 있습니다.</p>
<p>HTTP Smuggling 취약점의 가장 기본적인 예는 CL.TE Smuggling입니다. rawhttp 기반 요청에 대해 <code>unsafe: true</code> 속성을 사용하여 CE.TL HTTP Smuggling 취약점을 감지하는 예제 템플릿이 아래에 제공됩니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CL-TE-http-smuggling</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTTP request smuggling, basic CL.TE vulnerability</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdteam</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>
<span class="w">  </span><span class="nt">reference</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te</span>

<span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">      </span><span class="no">POST / HTTP/1.1</span>
<span class="w">      </span><span class="no">Host: {{Hostname}}</span>
<span class="w">      </span><span class="no">Connection: keep-alive</span>
<span class="w">      </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>
<span class="w">      </span><span class="no">Content-Length: 6</span>
<span class="w">      </span><span class="no">Transfer-Encoding: chunked</span>

<span class="w">      </span><span class="no">0</span>

<span class="w">      </span><span class="no">G      </span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|+</span>
<span class="w">      </span><span class="no">POST / HTTP/1.1</span>
<span class="w">      </span><span class="no">Host: {{Hostname}}</span>
<span class="w">      </span><span class="no">Connection: keep-alive</span>
<span class="w">      </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>
<span class="w">      </span><span class="no">Content-Length: 6</span>
<span class="w">      </span><span class="no">Transfer-Encoding: chunked</span>

<span class="w">      </span><span class="no">0</span>

<span class="w">      </span><span class="no">G</span>

<span class="w">    </span><span class="nt">unsafe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;Unrecognized</span><span class="nv"> </span><span class="s">method</span><span class="nv"> </span><span class="s">GPOST&#39;</span>
</code></pre></div>
<p>더 많은 예제는 다음에서 사용할 수 있습니다. <a href="https://nuclei.projectdiscovery.io/template-examples/http-smuggling/">template-examples</a> section for smuggling templates.</p>
<h4 id="race-conditions">Race conditions<a class="headerlink" href="#race-conditions" title="Permanent link">&para;</a></h4>
<p>경쟁 조건은 기존 도구를 통해 쉽게 자동화되지 않는 또 다른 유형의 버그입니다. Burp Suite는 모든 요청에 대한 모든 바이트가 전송 이벤트를 동기화하는 모든 요청에 대해 함께 전송되는 한 번에 마지막 바이트를 예상하는 Turbo Intruder에 게이트 메커니즘을 도입했습니다.</p>
<p>우리는 Nuclei 엔진에 <strong>Gate</strong> 메커니즘을 구현했으며 템플릿을 통해 실행할 수 있도록 하여 이 특정 버그 클래스에 대한 테스트를 간단하고 이식 가능하게 만듭니다.</p>
<p>템플릿 내에서 경쟁 조건 확인을 활성화하려면 <code>race</code> 속성을 <code>true</code>로 설정하고 <code>race_count</code>는 시작하려는 동시 요청 수를 정의합니다.</p>
<p>다음은 게이트 로직을 사용하여 동일한 요청이 10번 반복되는 예제 템플릿입니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">race-condition-testing</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Race condition testing</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pdteam</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>

<span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST /coupons HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>

<span class="w">        </span><span class="no">promo_code=20OFF        </span>

<span class="w">    </span><span class="nt">race</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">race_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">        </span><span class="nt">part</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">header</span>
<span class="w">        </span><span class="nt">status</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200</span>
</code></pre></div>
<p><code>POST</code> 요청을 취약한 것으로 의심되는 요청으로 교체하고 필요에 따라 <code>race_count</code>를 변경하면 실행할 준비가 됩니다.</p>
<div class="highlight"><pre><span></span><code>nuclei<span class="w"> </span>-t<span class="w"> </span>race.yaml<span class="w"> </span>-target<span class="w"> </span>https://api.target.com
</code></pre></div>
<p><strong>Multi request race condition testing</strong></p>
<p>경쟁 조건을 이용하기 위해 여러 요청을 보내야 하는 시나리오의 경우 스레드를 사용할 수 있습니다.</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">race</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p><code>threads</code>는 경쟁 조건 테스트를 수행하기 위해 템플릿으로 만들고자 하는 총 요청 수입니다.</p>
<p>다음은 게이트 로직을 사용하여 동시에 여러(5) 개의 고유 요청이 전송되는 예제 템플릿입니다.</p>
<div class="highlight"><pre><span></span><code><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multi-request-race</span>

<span class="nt">info</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Race condition testing with multiple requests</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pd-team</span>
<span class="w">  </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>

<span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span><span class="w">  </span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Pragma: no-cache</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>

<span class="w">        </span><span class="no">id=1</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Pragma: no-cache</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>

<span class="w">        </span><span class="no">id=2</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Pragma: no-cache</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>

<span class="w">        </span><span class="no">id=3</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Pragma: no-cache</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>

<span class="w">        </span><span class="no">id=4</span>

<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">POST / HTTP/1.1</span>
<span class="w">        </span><span class="no">Pragma: no-cache</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>
<span class="w">        </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">        </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>

<span class="w">        </span><span class="no">id=5</span>

<span class="w">    </span><span class="nt">threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">race</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<p><strong>Requests Annotation</strong></p>
<p>요청 인라인 주석은 요청 속성/동작 재정의에 따라 수행할 수 있습니다. python/java 클래스 주석과 매우 유사하며 RFC 라인 바로 앞에 요청에 넣어야 합니다. 현재 다음 재정의만 지원됩니다.:</p>
<ul>
<li><code>@Host:</code> 요청의 실제 대상을 재정의합니다(일반적으로 입력으로 제공되는 host/ip). ip/domain, port 및 schema가 있는 구문을 지원합니다(예: <code>domain.tld</code>, <code>domain.tld:port</code>, <code>http://domain.tld:port</code>).</li>
<li><code>@tls-sni:</code> 이는 TLS 요청의 SNI 이름(일반적으로 입력으로 제공된 호스트 이름)을 재정의합니다. 모든 리터럴을 지원하며 특수 값 <code>request.host</code>는 <code>Host</code> 헤더 값을 사용합니다.</li>
<li><code>@timeout:</code> 사용자 지정 기간에 대한 요청의 시간 초과를 재정의합니다. 문자열 형식의 기간을 지원합니다. 기간을 지정하지 않으면 기본 시간 초과 플래그 값이 사용됩니다.</li>
</ul>
<p>다음 예는 요청 내의 주석을 보여줍니다.</p>
<p><div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">@Host: https://projectdiscovery.io:443</span>
<span class="w">  </span><span class="no">POST / HTTP/1.1</span>
<span class="w">  </span><span class="no">Pragma: no-cache</span>
<span class="w">  </span><span class="no">Host: {{Hostname}}</span>
<span class="w">  </span><span class="no">Cache-Control: no-cache, no-transform</span>
<span class="w">  </span><span class="no">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0</span>
</code></pre></div>
이것은 예를 들어 여러 요청이 있는 템플릿의 경우에 특히 유용합니다. 초기 요청 이후에 하나의 요청을 특정 호스트에 대해 수행해야 하는 경우(예: API 유효성 검사):</p>
<div class="highlight"><pre><span></span><code><span class="nt">http</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">raw</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># this request will be sent to {{Hostname}} to get the token</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">GET /getkey HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: {{Hostname}}</span>

<span class="w">      </span><span class="c1"># This request will be sent instead to https://api.target.com:443 to verify the token validity</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">@Host: https://api.target.com:443</span>
<span class="w">        </span><span class="no">GET /api/key={{token}} HTTP/1.1</span>
<span class="w">        </span><span class="no">Host: api.target.com:443</span>

<span class="w">    </span><span class="nt">extractors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regex</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">token</span>
<span class="w">        </span><span class="nt">part</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">body</span>
<span class="w">        </span><span class="nt">regex</span><span class="p">:</span>
<span class="w">          </span><span class="c1"># random extractor of strings between prefix and suffix</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;prefix(.*)suffix&#39;</span>

<span class="w">    </span><span class="nt">matchers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">word</span>
<span class="w">        </span><span class="nt">part</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">body</span>
<span class="w">        </span><span class="nt">words</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">valid token</span>
</code></pre></div>
<p>사용자 지정 <code>timeout</code> 주석의 예 -</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">@timeout: 25s</span>
<span class="w">  </span><span class="no">POST /conf_mail.php HTTP/1.1</span>
<span class="w">  </span><span class="no">Host: {{Hostname}}</span>
<span class="w">  </span><span class="no">Content-Type: application/x-www-form-urlencoded</span>

<span class="w">  </span><span class="no">mail_address=%3B{{cmd}}%3B&amp;button=%83%81%81%5B%83%8B%91%97%90M</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2023 ProjectDiscovery, Inc.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/projectdiscovery/nuclei" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/pdnuclei" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.877163d5.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.1688372e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: ["tabs", "content.action.edit"],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.1b3b2620.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../../search/main.js"></script>
      
    
  </body>
</html>